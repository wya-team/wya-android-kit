# 交接文档


TODO项记得思考并进行优化

### 项目整体结构说明

```
├── CHANGELOG.md
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── LICENSE
├── aar -- 说明
    - `aar` -- 打包管理可避免每个library都进行编译 -- TODO 鉴于不仅是aar，也存在jar等其他类型，可考虑重命名为`repos` -- 仓库，kit、push等其他库依赖可考虑统一修改
        - release
        - snapshot
        发版前检查，将所有 `snapshot` 切换为 `release` 版本
├── app -- 说明
    - app
        - `maindexlist.txt` -- 分包时配置打包进main dex 。若启动时出现ClassNotFoundException, 可将该类添加至配置
├── bakApk -- 说明
    - `bakApk`
        每次build生成的中间产物，记得清理 若没有必要备份可修改
        `tinker-support.gradle`

        ```groovy
        def bakPath = file("${buildDir}/bakApk/") // -- clean会被清除
        def bakPath = file("../bakApk/") // -- 备份功能，有必要手动清除
        ```

        `app` 目录下 `build.gradle`

        ```groovy
        // rename apk
         android.applicationVariants.all {
                variant ->
                    variant.outputs.all {
                        outputFileName = "app_" + buildType.name + "_v${defaultConfig.versionName}_${releaseTime()}.apk"
                    }
            }
        ```
├── build
├── build.gradle
├── gradle -- 说明
    - gradle
        ```groovy
        ├── dependencies.gradle -- 所有的依赖管理 TODO 内容较多不直观，寻找方案
            - dependencies :
                - 引用库
                    `"com.android.support:recyclerview-v7:28.0.0"`

                    [group]:[name]:[version]
                    命名规则：取name 如 recyclerview_v7
                    将中划线“-”替换为下划线“_”
                    若有重复则再定义

                    library上传时命名注意 name保持小写并以“-”分隔
        ├── params_config.gradle -- 说明
            - 工程常量参数配置，主要处理包名替换受影响的参数
            - TODO 配置较繁琐，考虑替代方案 gradle.properties
        ├── properties
        │   └── wya-app-main.properties -- 工程常量参数配置
        └── wrapper
            ├── gradle-wrapper.jar
            └── gradle-wrapper.properties
        ```
├── gradle.properties -- 说明
    - gradle.properties

        ```
        // TODO 迁移至androidx
        // 表示使用 androidx
        android.useAndroidX=true

        // 表示将第三方库迁移到 androidx
        android.enableJetifier=true

        // 项目下aar上传目录 -- 建议统一修改为repos
        aar.deployPath=../../aar/snapshot
        aar.deployPath=../../aar/release

        ```
├── gradlew
├── gradlew.bat
├── local.properties
├── libs -- 说明
    - 开发并应用于项目中独立功能，抽离为library放置于项目中的libs中，根据库的使用决定是否抽离打包提供其他项目引用
    - 包名 `com.weiyian.android.+库名`
    ├── bugly -- 说明
        - 通用功能，封装抽离供引用
        - TODO bugly多个项目引用，可考虑统一配置管理
    ├── loadsir -- 说明
        - 优雅地处理加载中，重试，无数据等状态
        - [LoadSir](https://github.com/KingJA/LoadSir)
    ├── mock -- 说明
         - 模拟接口 -- 测试时使用
            `xxx.json` xxx为接口名 -- TODO 可优化避免重复
            不使用时，可改为 `test-xxx.json` 或移除拦截器
            注意 : 调试使用，正式环境务必移除

         - 使用 -- 网络请求框架添加拦截器`interceptor`

            ```kotlin
             .addInterceptor(OkHttpMockInterceptor(getAndroidProvider(), 0))

            ```
    ├── mvvm -- 说明
        - mvvm
            - 整体架构
            - 依赖注入 `koin` `kodein` 两个方案对比评估
            - 了解状态管理（如前端单向数据流）并加以应用
    ├── net -- 说明
        - 网络请求库
            - 结合RxJava2 + Retrofit2进行封装优化，参考 [RxEasyHttp](https://github.com/zhou-you/RxEasyHttp)
    ├── saripaar -- 说明
        - Android UI校验库
        - [android-saripaar](https://github.com/ragunathjawahar/android-saripaar)
    └── widget -- 说明
        ```
        ├── calendarview -- 说明
            - 日历控件 -- 根据实际需求进行定制化修改
            - [CalendarView](https://github.com/huanghaibin-dev/CalendarView)
        ├── circleprogress -- 说明
            - 仿google原生进度条，解决原生在低版本不兼容问题
        ├── count -- 说明
            - 倒计时View
        ├── floating -- 说明
            - 浮动按钮
        ├── fuzzy -- 说明
            - 模糊搜索
        ├── index -- 说明
            - 索引列表
        └── xpopup -- 说明
            - 弹窗组件，优化dismiss被销毁 TODO 根据实际需求优化后上传kit
            - [XPopup](https://github.com/li-xiaojun/XPopup)
        ```
├── sdk -- 说明
    - 业务以外的库考虑下沉至sdk进行引用
├── router.xmind -- 说明
    - [路由](media/router.xmind) 项目相关路由，新模块开发完毕后整理新增
├── settings.gradle -- 说明
    - settings
        ```groovy
        include ':xxx'
        project(':xxx').projectDir = new File('xx/xxx') // 位于某文件夹下的library
        ```
    - 顺序最好与目录顺序保持一致
└── wya.jks

```

- 调试工具
    - [stetho](https://github.com/facebook/stetho),结合Chrome Developer Tools进行调试
    - [pandora](https://github.com/whataa/pandora),基于github源码结合实际需求进行修改使用 -- TODO okhttp引用版本过高导致API19及以下的手机闪退
    - [hugo](https://github.com/JakeWharton/hugo),可打印一个方法的输入参数和函数的运行时间，在进行性能调优、减少应用卡顿时，可使用`hugo`寻找可优化的函数
    
- push项目地址: 

    ```
    http://192.168.0.116/native/push-android
    ```

- wya-android-kit
    - dev_libs分支

    

